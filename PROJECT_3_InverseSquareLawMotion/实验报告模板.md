# 项目：平方反比引力场中的运动 - 实验报告

**学生姓名：** [杨非豪]
**学号：** [20231050039]
**完成日期：** [2025.6.4]

## 1. 实验目的

（请用1-2句话简要描述本次实验你希望达成的学习目标，例如：通过数值模拟研究不同能量和角动量条件下质点在平方反比引力场中的轨道特性，并验证能量守恒和角动量守恒。）
通过数值模拟计算不同能量及角动量下质点在平方反比引力场中的运动方程，研究其轨道特性，同时验证能量和角动量守恒定律。

## 2. 核心算法与实现

### 2.1 运动方程与数值方法
（简要说明你所使用的运动方程（例如，直角坐标系下的二阶微分方程组）以及你选择的数值求解方法，如 `scipy.integrate.solve_ivp` 及其参数设置，或自行实现的算法如龙格-库塔法等。）
运动方程：直角坐标系下的二阶微分方程组。求解方法： `scipy.integrate.solve_ivp`，fun=derivatives,t_span=t_span,y0=initial_conditions,t_eval=t_eval,args=(gm_val,),method='RK45',rtol=1e-7，atol=1e-9。
   
### 2.2 关键函数实现思路
（选择1-2个你认为最核心的函数，例如 `derivatives` 或 `solve_orbit`，用3-5句话描述其实现思路和关键步骤。）
derivatives是函数计算的基础，通过引入数据，再通过公式进行对v的求解，同时注意r值取极小值的情况。
solve_orbit是计算微分方程的核心，设置好参数以及计算方法，便可以求出运动方程。
#### `[derivatives]` 实现思路：

```python
# 在此处粘贴你的核心代码片段 (5-10行)
x, y, vx, vy = state_vector
    r_cubed = (x ** 2 + y ** 2) ** 1.5
    if r_cubed < 1e-12:
        ax = -gm_val * x / (1e-12) if x != 0 else 0
        ay = -gm_val * y / (1e-12) if y != 0 else 0
        return [vx, vy, ax, ay]
    ax = -gm_val * x / r_cubed
    ay = -gm_val * y / r_cubed
    return [vx, vy, ax, ay]
# 例如 derivatives 函数的核心计算部分
```

#### `[solve_orbit]` 实现思路：

```python
# 在此处粘贴你的核心代码片段 (5-10行)
 sol = solve_ivp(
        fun=derivatives,
        t_span=t_span,
        y0=initial_conditions,
        t_eval=t_eval,
        args=(gm_val,),
        method='RK45',
        rtol=1e-7,
        atol=1e-9
    )
    return sol
# 例如 solve_orbit 函数调用 solve_ivp 的部分
```

## 3. 实验结果与分析

### 3.1 不同总能量下的轨道

（在此处展示并分析你针对任务 A 生成的轨道图像。确保图像清晰，包含必要的标签和图例。）
![E约等于0](https://github.com/user-attachments/assets/6eca6aa2-4237-445f-ad3b-a4686140f101)
![E小于0](https://github.com/user-attachments/assets/02f9ad90-1f20-4e49-9089-67179b46aa95)
![E大于0](https://github.com/user-attachments/assets/24baf9c1-a97d-4078-a7a0-c22ca8da7964)

**图1：不同能量下的轨道图 (E<0, E=0, E>0)**

```
[如果无法直接嵌入图像，请在此处描述图像内容，并指明图像文件名，例如：
 图像显示了三种能量条件下的轨道：
 - 椭圆轨道 (E = [具体值]): [简要描述形状和特征]
 - 抛物线轨道 (E = [具体值]): [简要描述形状和特征]
 - 双曲线轨道 (E = [具体值]): [简要描述形状和特征]
 中心天体位于原点。
 图像文件名：energy_orbits.png (示例)
]
```

**结果分析：**
（简要分析不同能量条件下轨道形状的差异及其物理意义。可以讨论能量与轨道是否束缚的关系。）
E<0为椭圆轨道，此时动能不足以克服引力势能，系统属于束缚态，对应开普勒第一定律；E≈0为抛物线轨道，此时刚好达到逃逸速度，动能与势能数值相等，对应彗星轨道；E>0为双曲线轨道，此时动能超过引力势能，系统处于非束缚态。
**(可选) 能量与角动量守恒验证：**
（如果你进行了能量和角动量随时间变化的计算和绘图，请在此处展示结果，并分析其守恒情况。讨论数值误差对守恒性的影响。）

### 3.2 不同角动量下的椭圆轨道 (E < 0)

（在此处展示并分析你针对任务 B 生成的轨道图像。）
![Ry=1](https://github.com/user-attachments/assets/3651a8ac-dc14-4e1f-baeb-1b2b0b50b79b)
![Ry=0 5](https://github.com/user-attachments/assets/9b6226d6-5f74-42fc-956f-3009711eb67c)

**图2：固定能量 (E=[-0.680])，不同角动量下的椭圆轨道**

```
[如果无法直接嵌入图像，请在此处描述图像内容，并指明图像文件名，例如：
 图像显示了能量 E=[具体值] 时，三个不同角动量 L1, L2, L3 下的椭圆轨道。
 - L1 = [值]: [描述轨道形状，如偏心率]
 - L2 = [值]: [描述轨道形状]
 - L3 = [值]: [描述轨道形状]
 图像文件名：angular_momentum_orbits.png (示例)
]
```

**结果分析：**
（分析角动量大小对椭圆轨道形状（如偏心率、半长轴、半短轴）的影响。角动量如何改变轨道的“扁平”程度？）
半长轴只与总能量有关，偏心率与角动量有关，角动量越大，偏心率越低，反之越大。
## 4. 问题与收获

### 4.1遇到的主要问题及解决方法
（列出你在完成项目中遇到的1-2个主要困难或挑战，并说明你是如何思考和解决这些问题的。）

**问题1：** [处理r取极小值问题时无法合理解决]
**解决方法：** [通过参考资料以及AI搜索，使用np.where等算法库加以解决]

**问题2：** [绘制角动量不同时的轨道图像有误]
**解决方法：** [加入公式进行计算验证]

### 4.2 主要收获与体会
（用3-5句话总结你通过本次实验获得的主要知识、技能或感悟。例如，对轨道力学的理解加深、数值求解ODE的经验、数据可视化的技巧等。）
通过模拟不同能量及角动量下的轨道，直观验证了平方反比引力场中的轨道性质，同时掌握了利用solve_ivp求解ODE的技巧，提升了数据可视化的技巧。
## 5. (可选) 思考与展望

（如果你完成了可选任务或有其他深入思考，可以在此部分阐述。）

### 5.1 坐标转换与对称性
（如果你研究了极坐标转换和轨道对称性，请在此处分享你的发现和理解。）
将运动方程代入极坐标中，可求得L与θ的关系式及角动量公式，揭示出轨道平面固定的原因，同时不同对称性如时间平移对应能量守恒，旋转对称性对应角动量守恒。
### 5.2 其他思考
（例如，此模型有哪些局限性？如何可以进一步扩展或改进这个项目？真实天体运动与此理想模型的差异等。）
缺陷：1.使用质点假设，忽略了天体自身尺寸，无法模拟自转等效应；2.力场理想化假设，需要广义相对论修正；3.存在数值误差累积问题。
改进：1.引入更加精确的物理模型，如加入相对论修正；2.数值方法优化。
